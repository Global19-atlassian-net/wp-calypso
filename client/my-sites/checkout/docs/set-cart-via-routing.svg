<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1014px" preserveAspectRatio="none" style="width:1273px;height:1014px;" version="1.1" viewBox="0 0 1273 1014" width="1273px" zoomAndPan="magnify"><defs><filter height="300%" id="f1bg0lmdl8z0r5" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F5E6B3" height="999.6875" style="stroke: #A80036; stroke-width: 1.0;" width="90" x="38" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="58" y="16.5684">Actions</text><rect fill="#B8E6BF" height="999.6875" style="stroke: #A80036; stroke-width: 1.0;" width="1023.5" x="226.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="669.25" y="16.5684">Composite Checkout</text><rect fill="#FFFFFF" filter="url(#f1bg0lmdl8z0r5)" height="388.1895" style="stroke: #000000; stroke-width: 2.0;" width="584.5" x="220.5" y="205.5293"/><rect fill="#FFFFFF" height="123.5078" style="stroke: none; stroke-width: 1.0;" width="584.5" x="220.5" y="331.3926"/><rect fill="#FFFFFF" height="138.8184" style="stroke: none; stroke-width: 1.0;" width="584.5" x="220.5" y="454.9004"/><rect fill="#FFFFFF" filter="url(#f1bg0lmdl8z0r5)" height="210.75" style="stroke: #000000; stroke-width: 2.0;" width="583" x="673" y="681.6504"/><rect fill="#FFFFFF" height="104.1973" style="stroke: none; stroke-width: 1.0;" width="583" x="673" y="788.2031"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="83" x2="83" y1="75.2871" y2="948.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="313.5" x2="313.5" y1="75.2871" y2="948.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="603" x2="603" y1="75.2871" y2="948.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="753" x2="753" y1="75.2871" y2="948.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="963" x2="963" y1="75.2871" y2="948.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1187" x2="1187" y1="75.2871" y2="948.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="42" y="72.334">/checkout/</text><ellipse cx="83" cy="42.7988" fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="79,30.7988,85,25.7988,83,30.7988,85,35.7988,79,30.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="42" y="961.2461">/checkout/</text><ellipse cx="83" cy="980.1992" fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="79,968.1992,85,963.1992,83,968.1992,85,973.1992,79,968.1992" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="235.5" y="39.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="242.5" y="60.334">CompositeCheckout</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="235.5" y="947.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="242.5" y="968.2461">CompositeCheckout</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="538" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="562.5" y="43.8457">usePrepare</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="545" y="60.334">ProductsForCart</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="538" y="947.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="562.5" y="968.2461">usePrepare</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="545" y="984.7344">ProductsForCart</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="688" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="695" y="43.8457">useAddProducts</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="723" y="60.334">FromUrl</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="688" y="947.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="695" y="968.2461">useAddProducts</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="723" y="984.7344">FromUrl</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="909" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="916" y="43.8457">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="916.5" y="60.334">CartManager</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="909" y="947.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="916" y="968.2461">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="916.5" y="984.7344">CartManager</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="1133" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1140" y="43.8457">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1142.5" y="60.334">CartReducer</text><rect fill="#FEFECE" filter="url(#f1bg0lmdl8z0r5)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="1133" y="947.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1140" y="968.2461">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1142.5" y="984.7344">CartReducer</text><path d="M8,90.2871 L8,130.2871 L154,130.2871 L154,100.2871 L144,90.2871 L8,90.2871 " fill="#FBFB77" filter="url(#f1bg0lmdl8z0r5)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M144,90.2871 L144,100.2871 L154,100.2871 L144,90.2871 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="14" y="107.8555">Extracts parameters</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="14" y="123.166">from URL path</text><polygon fill="#A80036" points="302,157.2188,312,161.2188,302,165.2188,306,161.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83" x2="308" y1="161.2188" y2="161.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="90" y="156.4766">productAliasFromUrl, purchaseId</text><polygon fill="#A80036" points="591,186.5293,601,190.5293,591,194.5293,595,190.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314" x2="597" y1="190.5293" y2="190.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="321" y="185.7871">productAliasFromUrl, purchaseId</text><path d="M220.5,205.5293 L282.5,205.5293 L282.5,212.5293 L272.5,222.5293 L220.5,222.5293 L220.5,205.5293 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="388.1895" style="stroke: #000000; stroke-width: 2.0;" width="584.5" x="220.5" y="205.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="235.5" y="219.0977">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="297.5" y="218.1641">[Renewal]</text><polygon fill="#FBFB77" filter="url(#f1bg0lmdl8z0r5)" points="444,227.8398,762,227.8398,772,246.8398,762,265.8398,444,265.8398,434,246.8398,444,227.8398" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="446" y="244.4082">has purchaseId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="446" y="259.7188">return 'addRenewalItems' from chooseAddHandler</text><polygon fill="#A80036" points="325,319.3926,315,323.3926,325,327.3926,321,323.3926" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="319" x2="602" y1="323.3926" y2="323.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="331" y="288.0293">&lt;&lt; createRenewalItemToAddToCart &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="363" y="303.3398">&lt;&lt; getRenewalItemFromCartItem &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="331" y="318.6504">renewalsForCart</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="220.5" x2="805" y1="332.3926" y2="332.3926"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="225.5" y="343.0273">[Plan]</text><polygon fill="#FBFB77" filter="url(#f1bg0lmdl8z0r5)" points="425,351.3477,781,351.3477,791,377.3477,781,404.3477,425,404.3477,415,377.3477,425,351.3477" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="427" y="367.916">no purchaseId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="352" x="427" y="383.2266">&amp;&amp; getUpgradePlanSlugFromPath( productAliasFromUrl )</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="427" y="398.5371">return 'addPlanFromSlug' from chooseAddHandler</text><polygon fill="#A80036" points="325,442.9004,315,446.9004,325,450.9004,321,446.9004" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="319" x2="602" y1="446.9004" y2="446.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="331" y="426.8477">&lt;&lt; createItemToAddToCart &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="331" y="442.1582">productsForCart</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="220.5" x2="805" y1="455.9004" y2="455.9004"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="225.5" y="466.5352">[Product]</text><polygon fill="#FBFB77" filter="url(#f1bg0lmdl8z0r5)" points="421,474.8555,785,474.8555,795,508.8555,785,543.8555,421,543.8555,411,508.8555,421,474.8555" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="423" y="491.4238">no purchaseId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="360" x="423" y="506.7344">&amp;&amp; ! getUpgradePlanSlugFromPath( productAliasFromUrl )</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="423" y="522.0449">&amp;&amp; has productAliasFromUrl</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="335" x="423" y="537.3555">return 'addProductFromSlug' from chooseAddHandler</text><polygon fill="#A80036" points="325,581.7188,315,585.7188,325,589.7188,321,585.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="319" x2="602" y1="585.7188" y2="585.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="331" y="565.666">&lt;&lt; createItemToAddToCart &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="331" y="580.9766">productsForCart</text><polygon fill="#A80036" points="325,618.0293,315,622.0293,325,626.0293,321,622.0293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="319" x2="962" y1="622.0293" y2="622.0293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="331" y="617.2871">addProductsToCart, replaceProductsInCart</text><polygon fill="#A80036" points="741,662.6504,751,666.6504,741,670.6504,745,666.6504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314" x2="747" y1="666.6504" y2="666.6504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="321" y="646.5977">addProductsToCart, replaceProductsInCart</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="321" y="661.9082">productsForCart renewalsForCart</text><path d="M673,681.6504 L735,681.6504 L735,688.6504 L725,698.6504 L673,698.6504 L673,681.6504 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="210.75" style="stroke: #000000; stroke-width: 2.0;" width="583" x="673" y="681.6504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="688" y="695.2188">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="750" y="694.2852">[Renewal]</text><polygon fill="#A80036" points="951,731.582,961,735.582,951,739.582,955,735.582" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="753" x2="957" y1="735.582" y2="735.582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="760" y="715.5293">&lt;&lt; replaceProductsInCart &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="760" y="730.8398">renewalsForCart</text><polygon fill="#A80036" points="1175,776.2031,1185,780.2031,1175,784.2031,1179,780.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963" x2="1181" y1="780.2031" y2="780.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="970" y="760.1504">dispatches</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="970" y="775.4609">CART_PRODUCTS_ADD</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="673" x2="1256" y1="789.2031" y2="789.2031"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="678" y="799.8379">[Plan/Product]</text><polygon fill="#A80036" points="951,835.7793,961,839.7793,951,843.7793,955,839.7793" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="753" x2="957" y1="839.7793" y2="839.7793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="760" y="819.7266">&lt;&lt; addProductsToCart &gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="760" y="835.0371">productsForCart</text><polygon fill="#A80036" points="1175,880.4004,1185,884.4004,1175,888.4004,1179,884.4004" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963" x2="1181" y1="884.4004" y2="884.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="970" y="864.3477">dispatches</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="970" y="879.6582">CART_PRODUCTS_REPLACE_ALL</text><path d="M1109,904.4004 L1109,929.4004 L1261,929.4004 L1261,914.4004 L1251,904.4004 L1109,904.4004 " fill="#FBFB77" filter="url(#f1bg0lmdl8z0r5)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1251,904.4004 L1251,914.4004 L1261,914.4004 L1251,904.4004 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="1115" y="921.9688">cacheStatus: 'invalid'</text><!--
@startuml


skinparam ParticipantPadding 5
skinparam BoxPadding 5

box "Actions" #f5e6b3
	control CheckoutController as "/checkout/"
end box
box "Composite Checkout" #b8e6bf
  participant CompositeCheckout
  participant usePrepareProductsForCart as "usePrepare\nProductsForCart"
  participant useAddProductsFromUrl as "useAddProducts\nFromUrl"
  participant useShoppingCartManager as "useShopping\nCartManager"
  participant useShoppingCartReducer as "useShopping\nCartReducer"
end box

note over CheckoutController
	Extracts parameters
	from URL path
end note
CheckoutController -> CompositeCheckout : productAliasFromUrl, purchaseId

CompositeCheckout -> usePrepareProductsForCart : productAliasFromUrl, purchaseId
alt Renewal
	hnote over usePrepareProductsForCart
		has purchaseId
		return 'addRenewalItems' from chooseAddHandler
	end hnote
	usePrepareProductsForCart -> CompositeCheckout : << createRenewalItemToAddToCart >>\n\t<< getRenewalItemFromCartItem >>\nrenewalsForCart
else Plan
	hnote over usePrepareProductsForCart
		no purchaseId
		&& getUpgradePlanSlugFromPath( productAliasFromUrl )
		return 'addPlanFromSlug' from chooseAddHandler
	end hnote
	usePrepareProductsForCart -> CompositeCheckout : << createItemToAddToCart >>\nproductsForCart
else Product
	hnote over usePrepareProductsForCart
		no purchaseId
		&& ! getUpgradePlanSlugFromPath( productAliasFromUrl )
		&& has productAliasFromUrl
		return 'addProductFromSlug' from chooseAddHandler
	end hnote
	usePrepareProductsForCart -> CompositeCheckout : << createItemToAddToCart >>\nproductsForCart
end
useShoppingCartManager -> CompositeCheckout : addProductsToCart, replaceProductsInCart
CompositeCheckout -> useAddProductsFromUrl : addProductsToCart, replaceProductsInCart\nproductsForCart renewalsForCart
alt Renewal
	useAddProductsFromUrl -> useShoppingCartManager : << replaceProductsInCart >>\nrenewalsForCart
	useShoppingCartManager -> useShoppingCartReducer : dispatches\nCART_PRODUCTS_ADD
else Plan/Product
	useAddProductsFromUrl -> useShoppingCartManager : << addProductsToCart >>\nproductsForCart
	useShoppingCartManager -> useShoppingCartReducer : dispatches\nCART_PRODUCTS_REPLACE_ALL
end
note over useShoppingCartReducer
	cacheStatus: 'invalid'
end note

@enduml

PlantUML version 1.2019.06(Fri May 24 12:10:25 CDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 14+36-1461
Operating System: Mac OS X
OS Version: 10.15.7
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>