<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="754px" preserveAspectRatio="none" style="width:1161px;height:754px;" version="1.1" viewBox="0 0 1161 754" width="1161px" zoomAndPan="magnify"><defs><filter height="300%" id="f9shu8rorfasm" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FACFD2" height="739.4512" style="stroke: #A80036; stroke-width: 1.0;" width="172" x="25" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="60" y="16.5684">WordPress.com</text><rect fill="#F7DCC6" height="739.4512" style="stroke: #A80036; stroke-width: 1.0;" width="141" x="254.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="298.5" y="16.5684">Calypso</text><rect fill="#B8E6BF" height="739.4512" style="stroke: #A80036; stroke-width: 1.0;" width="722" x="407.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="699.5" y="16.5684">Composite Checkout</text><rect fill="#FFFFFF" filter="url(#f9shu8rorfasm)" height="114.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="106" y="441.502"/><rect fill="#FFFFFF" filter="url(#f9shu8rorfasm)" height="173.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="320" y="396.8809"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="111" x2="111" y1="91.7754" y2="671.9863"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="324.5" x2="324.5" y1="91.7754" y2="671.9863"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="494.5" x2="494.5" y1="91.7754" y2="671.9863"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="647.5" x2="647.5" y1="91.7754" y2="671.9863"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="808.5" x2="808.5" y1="91.7754" y2="671.9863"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1060.5" x2="1060.5" y1="91.7754" y2="671.9863"/><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="34" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="44.5" y="43.8457">WPCOM_JSON_API_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="41" y="60.334">Me_Shopping_Cart_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="78" y="76.8223">Endpoint</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="63.4648" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="34" y="670.9863"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="44.5" y="691.5215">WPCOM_JSON_API_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="41" y="708.0098">Me_Shopping_Cart_</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="78" y="724.498">Endpoint</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="263.5" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="270.5" y="76.8223">Undocumented</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="263.5" y="670.9863"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="270.5" y="691.5215">Undocumented</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="416.5" y="56.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="423.5" y="76.8223">CompositeCheckout</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="416.5" y="670.9863"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="423.5" y="691.5215">CompositeCheckout</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="593.5" y="39.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="600.5" y="60.334">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="601" y="76.8223">CartManager</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="593.5" y="670.9863"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="600.5" y="691.5215">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="601" y="708.0098">CartManager</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="754.5" y="39.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="761.5" y="60.334">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="764" y="76.8223">CartReducer</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="754.5" y="670.9863"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="761.5" y="691.5215">useShopping</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="764" y="708.0098">CartReducer</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="1000.5" y="39.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="1007.5" y="60.334">useCartUpdate</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1009.5" y="76.8223">AndRevalidate</text><rect fill="#FEFECE" filter="url(#f9shu8rorfasm)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="1000.5" y="670.9863"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="1007.5" y="691.5215">useCartUpdate</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1009.5" y="708.0098">AndRevalidate</text><rect fill="#FFFFFF" filter="url(#f9shu8rorfasm)" height="114.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="106" y="441.502"/><rect fill="#FFFFFF" filter="url(#f9shu8rorfasm)" height="173.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="320" y="396.8809"/><polygon fill="#A80036" points="483,119.0859,493,123.0859,483,127.0859,487,123.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="325" x2="489" y1="123.0859" y2="123.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="332" y="118.3438">import setCart</text><path d="M415,136.0859 L415,176.0859 L570,176.0859 L570,146.0859 L560,136.0859 L415,136.0859 " fill="#FBFB77" filter="url(#f9shu8rorfasm)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M560,136.0859 L560,146.0859 L570,146.0859 L560,136.0859 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="421" y="153.6543">setCart from props</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="421" y="168.9648">or fall back to import</text><polygon fill="#A80036" points="635.5,203.0176,645.5,207.0176,635.5,211.0176,639.5,207.0176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="495" x2="641.5" y1="207.0176" y2="207.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="502" y="202.2754">setCart</text><polygon fill="#A80036" points="1048.5,232.3281,1058.5,236.3281,1048.5,240.3281,1052.5,236.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647.5" x2="1054.5" y1="236.3281" y2="236.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="654.5" y="231.5859">setCart</text><polygon fill="#FBFB77" filter="url(#f9shu8rorfasm)" points="741,249.3281,876,249.3281,886,260.3281,876,272.3281,741,272.3281,731,260.3281,741,249.3281" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="743" y="265.8965">cacheStatus: 'invalid'</text><polygon fill="#A80036" points="658.5,294.9492,648.5,298.9492,658.5,302.9492,654.5,298.9492" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="652.5" x2="807.5" y1="298.9492" y2="298.9492"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="664.5" y="294.207">cacheStatus, dispatch</text><polygon fill="#A80036" points="1048.5,324.2598,1058.5,328.2598,1048.5,332.2598,1052.5,328.2598" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647.5" x2="1054.5" y1="328.2598" y2="328.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="654.5" y="323.5176">cacheStatus, dispatch</text><path d="M967,341.2598 L967,366.2598 L1149,366.2598 L1149,351.2598 L1139,341.2598 L967,341.2598 " fill="#FBFB77" filter="url(#f9shu8rorfasm)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1139,341.2598 L1139,351.2598 L1149,351.2598 L1139,341.2598 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="973" y="358.8281">cacheStatus === 'invalid'</text><polygon fill="#A80036" points="341,392.8809,331,396.8809,341,400.8809,337,396.8809" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="1059.5" y1="396.8809" y2="396.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="347" y="392.1387">&lt;&lt; setCart &gt;&gt;</text><polygon fill="#A80036" points="127,437.502,117,441.502,127,445.502,123,441.502" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="319" y1="441.502" y2="441.502"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="133" y="421.4492">POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="133" y="436.7598">/me/shopping-cart/{cartKey}</text><path d="M8,454.502 L8,540.502 L210,540.502 L210,464.502 L200,454.502 L8,454.502 " fill="#FBFB77" filter="url(#f9shu8rorfasm)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M200,454.502 L200,464.502 L210,464.502 L200,454.502 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="14" y="472.0703">May be passed:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="487.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="14" y="502.6914">{ extra: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="46" y="518.002">purchaseType: 'renewal'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="14" y="533.3125">} }</text><polygon fill="#A80036" points="308,552.0547,318,556.0547,308,560.0547,312,556.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="111" x2="314" y1="556.0547" y2="556.0547"/><polygon fill="#A80036" points="1048.5,566.0547,1058.5,570.0547,1048.5,574.0547,1052.5,570.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="325" x2="1054.5" y1="570.0547" y2="570.0547"/><polygon fill="#A80036" points="819.5,610.6758,809.5,614.6758,819.5,618.6758,815.5,614.6758" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="813.5" x2="1059.5" y1="614.6758" y2="614.6758"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="825.5" y="594.623">dispatches</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="825.5" y="609.9336">RECEIVE_UPDATED_RESPONSE_CART</text><path d="M736,627.6758 L736,652.6758 L876,652.6758 L876,637.6758 L866,627.6758 L736,627.6758 " fill="#FBFB77" filter="url(#f9shu8rorfasm)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M866,627.6758 L866,637.6758 L876,637.6758 L866,627.6758 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="742" y="645.2441">cacheStatus: 'valid'</text><!--
@startuml


skinparam ParticipantPadding 5
skinparam BoxPadding 5
box "WordPress.com" #facfd2
  participant WPCOM_JSON_API_Me_Shopping_Cart_Endpoint as "WPCOM_JSON_API_\nMe_Shopping_Cart_\nEndpoint"
end box
box "Calypso" #f7dcc6
  participant Undocumented
end box
box "Composite Checkout" #b8e6bf
  participant CompositeCheckout
  participant useShoppingCartManager as "useShopping\nCartManager"
  participant useShoppingCartReducer as "useShopping\nCartReducer"
  participant useCartUpdateAndRevalidate as "useCartUpdate\nAndRevalidate"
end box

Undocumented -> CompositeCheckout : import setCart
note over CompositeCheckout
	setCart from props
	or fall back to import
end note
CompositeCheckout -> useShoppingCartManager : setCart
useShoppingCartManager -> useCartUpdateAndRevalidate : setCart
hnote over useShoppingCartReducer
	cacheStatus: 'invalid'
end hnote
useShoppingCartReducer -> useShoppingCartManager : cacheStatus, dispatch
useShoppingCartManager -> useCartUpdateAndRevalidate : cacheStatus, dispatch
note over useCartUpdateAndRevalidate
	cacheStatus === 'invalid'
end note
useCartUpdateAndRevalidate -> Undocumented : << setCart >>
activate Undocumented
Undocumented -> WPCOM_JSON_API_Me_Shopping_Cart_Endpoint : POST\n/me/shopping-cart/{cartKey}
activate WPCOM_JSON_API_Me_Shopping_Cart_Endpoint
note over WPCOM_JSON_API_Me_Shopping_Cart_Endpoint
	May be passed:

	{ extra: {
		purchaseType: 'renewal'
	} }
end note
return
return
useCartUpdateAndRevalidate -> useShoppingCartReducer : dispatches\nRECEIVE_UPDATED_RESPONSE_CART
note over useShoppingCartReducer
	cacheStatus: 'valid'
end note

@enduml

PlantUML version 1.2019.06(Fri May 24 12:10:25 CDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 14+36-1461
Operating System: Mac OS X
OS Version: 10.15.7
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>